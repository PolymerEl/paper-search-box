<link rel="import" href="../../polymer/polymer.html">

<script>
  Polymer({
    is: 'iron-ajax',

    properties: {
      params: Object,
      lastResponse: {
        type: Object,
        notify: true
      },
      loading: {
        type: Boolean,
        notify: true
      },
      debounceDuration: Number
    },

    observers: [
      'send(params.*)'
    ],

    ready: function() {
      this.set('mockData', [{
       label: 'Polymer University',
            id: 'Polymer',
            type: 'School'
          }, {
            label: 'Salte University',
            id: 'Salte',
            type: 'School'
          }, {
            label: 'Another looong University',
            id: 'another',
            type: 'School'
      }]);
    },

    send: function() {
      this.debounce('request', function() {
        this.set('loading', true);
        setTimeout(function() {
          if (this.params.search) {
            this.set('lastResponse', this.mockData.filter(function(value) {
              return value.label.toUpperCase().indexOf(this.params.search.toUpperCase()) > -1;
            }.bind(this)));
          } else {
            this.set('lastResponse', this.mockData);
          }
          this.set('loading', false);
        }.bind(this), 500);
      }.bind(this), this.debounceDuration);
    }
  });
</script>
